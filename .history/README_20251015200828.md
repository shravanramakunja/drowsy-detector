# Real-Time Drowsiness Detection System

A simple and effective drowsiness detection system that monitors eye closure in real-time using computer vision.

## Features

- **Real-time Eye Tracking**: Uses facial landmarks to detect eye positions
- **Eye Aspect Ratio (EAR)**: Calculates EAR to determine if eyes are closed
- **Audio Alert**: Plays alarm sound when drowsiness is detected
- **Visual Feedback**: Shows live video feed with eye contours and status

## How It Works

1. **Face Detection**: Detects faces using dlib's frontal face detector
2. **Landmark Detection**: Identifies 68 facial landmarks including eye coordinates
3. **EAR Calculation**: Computes Eye Aspect Ratio - when eyes close, EAR drops
4. **Alert System**: If eyes remain closed for consecutive frames, triggers alarm

### Eye Aspect Ratio (EAR) Formula

```
EAR = (||p2 - p6|| + ||p3 - p5||) / (2 * ||p1 - p4||)
```

Where p1-p6 are the eye landmark points.

## Installation

1. **Install Python dependencies**:
```bash
pip install -r requirements.txt
```

2. **Download the facial landmark predictor**:
   - Download from: http://dlib.net/files/shape_predictor_68_face_landmarks.dat.bz2
   - Extract the `.bz2` file
   - Place `shape_predictor_68_face_landmarks.dat` in the project directory

## Usage

Run the script:
```bash
python drowsiness.py
```

**Controls**:
- Press `q` to quit the application

## Parameters

You can adjust these parameters in the code:

- `EAR_THRESHOLD = 0.25`: Eye Aspect Ratio threshold (lower = more sensitive)
- `EAR_CONSEC_FRAMES = 20`: Number of consecutive frames for drowsiness detection

## Requirements

- Python 3.7+
- Webcam
- Good lighting conditions
- Clear view of face

## Troubleshooting

**Error: Could not open webcam**
- Check if camera is connected
- Ensure no other application is using the camera

**Error: shape_predictor file not found**
- Download the predictor file as mentioned in installation steps

**Low detection accuracy**
- Improve lighting conditions
- Adjust camera position for clear face view
- Try adjusting `EAR_THRESHOLD` value

## Credits

Based on the Eye Aspect Ratio method for drowsiness detection.
