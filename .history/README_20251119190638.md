# ğŸš— Smart Driver Hub - Drowsiness Detection System

[![Python](https://img.shields.io/badge/Python-3.7%2B-blue.svg)](https://www.python.org/)
[![OpenCV](https://img.shields.io/badge/OpenCV-4.x-green.svg)](https://opencv.org/)
[![Flask](https://img.shields.io/badge/Flask-2.x-lightgrey.svg)](https://flask.palletsprojects.com/)
[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)

A comprehensive real-time drowsiness detection system that monitors driver alertness using computer vision and machine learning. The system tracks eye closure patterns and triggers audio-visual alerts when drowsiness is detected, helping prevent accidents caused by driver fatigue.

> **Perfect for:** Road safety projects, driver monitoring systems, fleet management, autonomous vehicle research, and educational purposes.

## âœ¨ Features

### Core Detection
- ğŸ‘ï¸ **Real-time Eye Tracking** - Uses OpenCV Haar Cascade classifiers for accurate eye detection
- â±ï¸ **Customizable Alert Threshold** - Set drowsiness detection time (3-10 seconds, default: 5s)
- ğŸ”Š **Audio Alerts** - Loud alarm sound using Pygame to wake drowsy drivers
- ğŸ“Š **Live Status Display** - Real-time timer showing eye closure duration
- ğŸ¥ **Video Feed Overlay** - Visual rectangles highlighting detected faces and eyes

### Two Deployment Options
1. **ğŸ–¥ï¸ Standalone Desktop App** - Quick Python script with OpenCV window
2. **ğŸŒ Web Application** - Modern responsive UI with Flask backend and REST API

### Machine Learning Integration
- ğŸ¤– **Fuel Efficiency Predictor** - Random Forest ML model trained on 38,113+ real vehicle records
- ğŸ“Š **Real Dataset** - Uses actual automotive data (MPG, engine specs, transmission, vehicle class)
- ğŸ¯ **Accurate Predictions** - City, Highway, and Combined fuel efficiency (km/l)
- ğŸ“ **Feature Engineering** - 6 key features: cylinders, displacement, transmission, class, drive, fuel type
- ğŸ”„ **Automatic Training** - Models train on server startup using scikit-learn

### Additional Features
- âš™ï¸ **Adjustable Settings** - Configure volume, threshold, and sound preferences
- ğŸ¨ **Professional UI** - Clean, intuitive interface with smooth animations
- ğŸ”§ **Easy Setup** - Dependencies install via pip, automatic dataset loading
- ğŸš— **Sample Vehicles** - 12 pre-loaded realistic vehicle profiles for testing
- ğŸ“± **Cross-Platform** - Works on Windows, macOS, and Linux

## ğŸ“‹ Table of Contents
- [Quick Start](#-quick-start)
- [Installation](#-installation)
- [Usage](#-usage)
  - [Standalone Desktop App](#1-standalone-desktop-app)
  - [Web Application](#2-web-application)
- [Project Structure](#-project-structure)
- [Configuration](#-configuration)
- [Troubleshooting](#-troubleshooting)
- [How It Works](#-how-it-works)
- [Contributing](#-contributing)
- [Roadmap](#-roadmap)
- [License](#-license)

## ğŸš€ Quick Start

```bash
# Clone the repository
git clone https://github.com/shravanramakunja/drowsy-detector.git
cd drowsy-detector

# Install dependencies
pip install -r requirements.txt

# Run standalone app
python drowsiness.py

# OR run web version
python app.py
# Then open http://localhost:5000
```

## ğŸ“¦ Installation

---

## Installation

### Prerequisites

- **Python 3.7+** (Python 3.12 recommended)
- **Webcam** (built-in or USB)
- **Operating System**: Windows, macOS, or Linux
- **Internet connection** (for initial package installation only)

### Step 1: Clone the Repository

```bash
# Using Git
git clone https://github.com/shravanramakunja/drowsy-detector.git
cd drowsy-detector

# Or download ZIP and extract
# Then navigate to the extracted folder
```

### Step 2: Create Virtual Environment (Recommended)

```bash
# Windows
python -m venv venv
venv\Scripts\activate

# macOS/Linux
python3 -m venv venv
source venv/bin/activate
```

### Step 3: Install Dependencies

```bash
pip install -r requirements.txt
```

**Dependencies installed:**

- `opencv-python==4.8.1.78` - Computer vision and face/eye detection
- `numpy==1.24.3` - Numerical operations and array handling
- `pygame==2.5.2` - Audio playback for alarm sounds
- `flask==3.0.0` - Web server framework
- `flask-cors==4.0.0` - Cross-origin resource sharing support
- `scikit-learn==1.3.2` - Machine learning (Random Forest algorithm)
- `pandas==2.1.4` - Dataset loading and preprocessing

**Troubleshooting installation:**

```bash
# Upgrade pip first
python -m pip install --upgrade pip

# Install with verbose output
pip install -r requirements.txt --verbose

# Or install packages individually
pip install opencv-python numpy pygame flask flask-cors scikit-learn pandas
```

---

## ğŸ¯ Usage

### 1. Standalone Desktop App

Opens a desktop window with live camera feed and detection.

**Steps:**

1. **Run the script:**

   ```bash
   python drowsiness.py
   ```

2. **What happens:**
   - Camera window opens showing live feed
   - Blue rectangle highlights detected face
   - Green rectangles show detected eyes (when open)
   - Status displayed at bottom: Active/ALERT and timer

3. **Test drowsiness detection:**
   - Close your eyes for 5+ seconds
   - Alarm sounds automatically
   - Red "DROWSINESS ALERT!" text appears
   - Open eyes to stop alarm

4. **Exit:** Press `q` or `t` key

**Keyboard Shortcuts:**

| Key | Action |
|-----|--------|
| `q` | Quit application |
| `t` | Quit application |

### 2. Web Application

Modern browser-based interface with enhanced UI/UX.

**Steps:**

1. **Start the Flask server:**

   ```bash
   python app.py
   ```

   You'll see:

   ```text
   ============================================================
   Smart Driver Hub - Drowsiness Detection Backend
   ============================================================
   [INFO] Access the web interface at: http://localhost:5000
   * Running on http://0.0.0.0:5000
   ```

2. **Open your browser:**

   Navigate to [http://localhost:5000](http://localhost:5000)

3. **Use the interface:**
   - Scroll to "Start Drowsiness Detection" section
   - Adjust settings (threshold, volume, sound toggle)
   - Click **"Start Detection"** button
   - Video feed appears with detection overlay
   - Status panel shows real-time updates

4. **Test the system:**
   - Close eyes and watch timer count up
   - Alert triggers at threshold (default 5s)
   - Red alert box appears, alarm sounds

5. **Stop:** Click **"Stop Detection"** button

6. **Shutdown:** Press `Ctrl+C` in terminal to stop server

**Bonus Feature - Fuel Efficiency Predictor:**

- Click "Predict Fuel Efficiency" in Features section
- Select sample dataset or enter custom vehicle data
- View estimated fuel efficiency (km/l) for city/highway

---

## ğŸ“ Project Structure

```text
drowsy-detector/
â”œâ”€â”€ drowsiness.py          # Standalone desktop application
â”œâ”€â”€ app.py                 # Flask backend server
â”œâ”€â”€ requirements.txt       # Python dependencies
â”œâ”€â”€ README.md             # Project documentation
â”œâ”€â”€ QUICKSTART.md         # Quick setup guide
â”œâ”€â”€ web/                  # Web application files
â”‚   â”œâ”€â”€ index.html        # Main HTML page
â”‚   â”œâ”€â”€ styles.css        # CSS styling
â”‚   â”œâ”€â”€ script.js         # Frontend JavaScript logic
â”‚   â””â”€â”€ README.md         # Web-specific documentation
â””â”€â”€ .gitignore           # Git ignore rules
```

---

## âš™ï¸ Configuration

### Adjustable Parameters

| Parameter | Default | Range | Description |
|-----------|---------|-------|-------------|
| `EYE_CLOSED_SECONDS` | 5 | 3-10 | Seconds before alarm triggers |
| Alarm Volume | 80% | 0-100% | Loudness of alarm sound |
| Sound Enable | On | On/Off | Enable/disable audio alerts |
| Camera Index | 0 | 0-2 | Which camera device to use |

### Modifying Detection Threshold

**Standalone (`drowsiness.py`):**

```python
# Line ~26
self.EYE_CLOSED_SECONDS = 5  # Change to 3-10 seconds
```

**Web App:** Use the slider in Settings panel (3-10 seconds)

### Changing Camera Source

Edit `drowsiness.py` or `app.py`:

```python
# Try different camera indices: 0 (default), 1, 2
cap = cv2.VideoCapture(1)  # Use second camera
```

---

## ğŸ› Troubleshooting

<details>
<summary><b>Camera Not Working</b></summary>

**Problem:** "Could not open webcam" or "Failed to grab frame"

**Solutions:**

1. Check camera permissions:
   - Windows: Settings â†’ Privacy â†’ Camera â†’ Allow apps
   - macOS: System Preferences â†’ Security & Privacy â†’ Camera
   - Linux: Check camera device exists (`ls /dev/video*`)

2. Close other applications using camera (Zoom, Skype, Teams)

3. Try different camera index (0, 1, or 2)

4. Restart computer to reset camera drivers

5. Check camera works in other apps first

</details>

<details>
<summary><b>Module Not Found Errors</b></summary>

**Problem:** `ModuleNotFoundError: No module named 'opencv'`

**Solutions:**

```bash
# Upgrade pip
python -m pip install --upgrade pip

# Reinstall dependencies
pip uninstall opencv-python numpy pygame flask flask-cors
pip install -r requirements.txt

# Or install individually
pip install opencv-python numpy pygame flask flask-cors
```

Ensure you're using the same Python environment where packages were installed.

</details>

<details>
<summary><b>No Alarm Sound</b></summary>

**Problem:** Alarm doesn't play when drowsiness detected

**Solutions:**

1. Check system volume (not muted)
2. Windows: Volume Mixer â†’ ensure Python volume is up
3. Test speakers with music/video
4. Web version: Enable "Sound Alerts" checkbox
5. Adjust "Alarm Volume" slider in settings

</details>

<details>
<summary><b>Web App Connection Issues</b></summary>

**Problem:** "Unable to connect to backend server"

**Solutions:**

1. Verify Flask server is running (check terminal output)
2. Use correct URL: `http://localhost:5000` (not `https://`)
3. Check firewall settings (allow Python)
4. Port conflict? Change port in `app.py`:

   ```python
   app.run(debug=False, host='0.0.0.0', port=5001)  # Try different port
   ```

</details>

<details>
<summary><b>Poor Eye Detection</b></summary>

**Problem:** Eyes not detected or false positives

**Solutions:**

1. **Improve lighting:** Face should be well-lit, no backlighting
2. **Remove glasses:** May interfere with detection
3. **Face the camera directly:** Not at an angle
4. **Optimal distance:** Sit 1-3 feet from camera
5. **Clean lens:** Remove smudges from camera
6. **Adjust threshold:** Make system more/less sensitive

</details>

---

## ğŸ” How It Works

### Detection Algorithm

1. **Face Detection** â†’ Haar Cascade classifier locates faces in frame
2. **Eye Detection** â†’ Searches upper 60% of face region for eyes
3. **State Monitoring** â†’ Counts detected eye pairs:
   - â‰¥2 eyes detected â†’ Eyes OPEN
   - <2 eyes detected â†’ Eyes CLOSED
4. **Timer Tracking** â†’ Measures continuous eye closure duration
5. **Alert Trigger** â†’ If duration > threshold â†’ Sound alarm

### Technology Stack

| Technology | Purpose |
|------------|---------|
| **Python 3.12** | Core programming language |
| **OpenCV** | Computer vision & face/eye detection |
| **NumPy** | Array operations & signal generation |
| **Pygame** | Audio playback for alarm sounds |
| **Flask** | Web server framework |
| **HTML/CSS/JS** | Modern responsive frontend UI |

### Detection Flow

```text
Camera Feed â†’ Grayscale Conversion â†’ Face Detection
     â†“
Eye Region Extraction â†’ Eye Detection â†’ State Analysis
     â†“
Timer Update â†’ Threshold Check â†’ Alert Decision
     â†“
Visual Overlay + Audio Alarm (if needed)
```

---

## ğŸ¤ Contributing

Contributions are welcome! Here's how you can help:

### Reporting Issues

1. Check existing issues first
2. Include:
   - OS and Python version
   - Error messages/screenshots
   - Steps to reproduce
   - Expected vs actual behavior

### Submitting Pull Requests

1. **Fork the repository**

   ```bash
   git clone https://github.com/YOUR_USERNAME/drowsy-detector.git
   cd drowsy-detector
   ```

2. **Create a feature branch**

   ```bash
   git checkout -b feature/your-feature-name
   ```

3. **Make your changes**
   - Follow existing code style
   - Add comments for complex logic
   - Test thoroughly

4. **Commit with clear messages**

   ```bash
   git add .
   git commit -m "feat: add new detection algorithm"
   ```

5. **Push and create PR**

   ```bash
   git push origin feature/your-feature-name
   ```

   Then open a Pull Request on GitHub

### Contribution Ideas

- ğŸ¯ Improve detection accuracy
- ğŸŒ Add multi-language support
- ğŸ“Š Add statistics dashboard
- ğŸ”Š Additional alert types (vibration, notifications)
- ğŸ“± Mobile app version
- ğŸ§ª Add unit tests
- ğŸ“š Improve documentation
- ğŸ¨ UI/UX enhancements

---

## ğŸ—ºï¸ Roadmap

### Version 2.0 (Planned)

- [ ] Machine learning-based drowsiness detection
- [ ] Face landmark detection (dlib or MediaPipe)
- [ ] Blink rate analysis
- [ ] Yawn detection
- [ ] Head pose estimation
- [ ] Statistics and logging
- [ ] Cloud deployment support
- [ ] Mobile app (React Native)
- [ ] Multiple camera support
- [ ] Export detection reports

### Future Enhancements

- Integration with vehicle systems
- Real-time notifications to emergency contacts
- Driver behavior analytics
- Multi-driver support
- Database integration for history tracking

---

## ğŸ“„ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

---

## ğŸ‘ Acknowledgments

- OpenCV community for computer vision tools
- Haar Cascade classifiers for face/eye detection
- Flask team for excellent web framework
- Pygame for audio support
- All contributors and users of this project

---

## ğŸ“§ Contact & Support

- **Issues:** [GitHub Issues](https://github.com/shravanramakunja/drowsy-detector/issues)
- **Discussions:** [GitHub Discussions](https://github.com/shravanramakunja/drowsy-detector/discussions)
- **Email:** Contact via GitHub profile

---

## â­ Star This Repository

If you find this project helpful, please give it a star! It helps others discover the project.

[![GitHub stars](https://img.shields.io/github/stars/shravanramakunja/drowsy-detector?style=social)](https://github.com/shravanramakunja/drowsy-detector/stargazers)

---

**Made with â¤ï¸ for safer roads and alert drivers**
